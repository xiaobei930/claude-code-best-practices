# Ralph Loop 提示词模板 - 完全自主设计开发

## 任务目标

从需求描述开始，**完全自主**完成功能的设计、开发、测试和交付。

## 输入

<!-- 在此填写需求描述 -->
```
需求: {{FEATURE_DESCRIPTION}}
```

---

## 完整开发流程

### Phase 1: 需求分析（/cc-best:pm 角色）

1. **理解需求**
   - 读取需求描述
   - 分析用户场景
   - 识别功能边界

2. **输出 REQ 文档**
   - 创建 `docs/requirements/REQ-XXX.md`
   - 定义 User Stories（按 P1/P2/P3 优先级）
   - 明确验收标准
   - 标注决策置信度

3. **自主决策原则**
   - 基于项目上下文推断，不中断询问用户
   - 参考 `memory-bank/architecture.md` 和 `tech-stack.md`
   - 无依据时采用 MVP 原则，标注"待确认"

### Phase 2: 技术设计（/cc-best:lead 角色）

1. **架构设计**
   - 分析技术可行性
   - 设计模块结构
   - 定义接口契约

2. **任务拆分**
   - 按 User Story 组织任务
   - 每个任务 = 一个最小可交付单元
   - 标注任务依赖关系和可并行性

3. **输出 DES + TSK 文档**
   - 创建 `docs/designs/DES-XXX.md`
   - 创建 `docs/tasks/TSK-XXX.md`（每个任务一个）
   - 更新 `memory-bank/progress.md`

### Phase 3: 前端设计（/cc-best:designer 角色，如涉及前端）

1. **设计审查**
   - 确定美学方向
   - 定义颜色/字体/布局方案
   - 避免 AI 通用审美

2. **输出设计指导**
   - 在 DES 文档中补充 UI 设计章节

### Phase 4: 编码实现（/cc-best:dev 角色）

1. **按任务顺序执行**
   - 从 P1 (MVP) 任务开始
   - 每完成一个任务就提交

2. **编码规范**
   - 遵循项目代码风格
   - 函数单一职责
   - 嵌套 ≤ 3 层

3. **自测**
   - 编写单元测试
   - 前端: 浏览器验证

### Phase 5: 测试验证（/cc-best:qa 角色）

1. **验收测试**
   - 按 User Story 验收标准验证
   - 区分"实现 Bug"和"需求假设错误"

2. **问题处理**
   - 实现 Bug → 立即修复
   - 假设错误 → 记录待后续确认

### Phase 6: 完成交付

1. **文档更新**
   - 更新 `memory-bank/progress.md`
   - 标记 REQ/DES/TSK 状态为 completed

2. **提交代码**
   - 使用 Conventional Commits
   - 确保所有测试通过

---

## 迭代流程

每次迭代执行以下步骤：

```
1. 读取 progress.md 确定当前阶段
2. 根据阶段执行对应角色任务
3. 完成后更新文档
4. 提交代码（如有）
5. 进入下一阶段/任务
```

---

## 完成标准

当满足以下**所有**条件时输出 `<promise>FEATURE_COMPLETE</promise>`：

- [ ] REQ 文档已创建，User Stories 已定义
- [ ] DES 文档已创建，架构设计完成
- [ ] 所有 P1 (MVP) 任务已完成
- [ ] 所有测试通过
- [ ] 代码已提交
- [ ] progress.md 已更新为完成状态

---

## 关键规则

### 自主决策
- **不中断询问用户** - 基于上下文推断
- **记录决策依据** - 标注置信度（高/中/低）
- **下游可纠偏** - Lead 可调整 PM 决策

### 编码规范
- **禁止猜测接口** - 调用前必须查阅文档
- **禁止假设业务** - 业务逻辑必须有来源
- **小步提交** - 每个原子任务一个 commit

### 质量保证
- **测试先行** - 重要功能先写测试
- **持续验证** - 每次修改后运行测试
- **前端验证** - 使用浏览器工具检查

---

## 卡住时的处理

### 需求不清晰
1. 基于 MVP 原则做最小实现
2. 在 REQ 文档标注"待确认"
3. 继续开发，不阻塞

### 技术难题
1. 尝试 3 种不同方案
2. 记录失败原因
3. 如果都失败，输出 `<promise>BLOCKED_TECH</promise>`

### 依赖缺失
1. 尝试 Mock 或桩实现
2. 记录依赖项
3. 如果无法绕过，输出 `<promise>BLOCKED_DEP</promise>`

---

## 输出格式

```markdown
## 开发迭代 #N

### 当前阶段
[Phase X: 阶段名称]

### 当前角色
[/cc-best:pm | /cc-best:lead | /cc-best:designer | /cc-best:dev | /cc-best:qa]

### 执行动作
1. [动作1]
2. [动作2]

### 产出物
- 文档: [创建/更新的文档]
- 代码: [修改的文件]
- 提交: [commit hash]

### 决策记录
| 决策点 | 选择 | 依据 | 置信度 |
|--------|------|------|--------|
| [决策1] | [选择] | [依据] | 高/中/低 |

### 下一步
[下一阶段/任务 或 完成信号]
```

---

## 使用示例

```bash
/ralph-loop "读取 .claude/ralph-prompts/full-feature.md 作为执行指南。需求: 实现用户登录功能，包含邮箱密码登录和 OAuth 登录。" --max-iterations 50 --completion-promise "FEATURE_COMPLETE"
```
